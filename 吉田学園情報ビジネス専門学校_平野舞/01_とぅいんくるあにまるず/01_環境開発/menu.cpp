//-----------------------------------------------------------------------------------------------
//
// メニューの処理[menu.cpp]
// Author : 平野舞
//
//-----------------------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------------------
// インクルードファイル
//-----------------------------------------------------------------------------------------------
#include "menu.h"					// メニュー

//-----------------------------------------------------------------------------------------------
// 定数宣言
//-----------------------------------------------------------------------------------------------
// 幅
static const float MENU_WIDTH = 350.0f;
// 高さ
static const float MENU_HEIGHT = 170.0f;
// 点滅間隔
static const int MENU_INTERVAL_BLINK = 30;

//-----------------------------------------------------------------------------------------------
// コンストラクタ
//-----------------------------------------------------------------------------------------------
CMenu::CMenu()
	: m_state(MENU_STATE_NO_DECISION), m_nCount(0)
{

}

//-----------------------------------------------------------------------------------------------
// デストラクタ
//-----------------------------------------------------------------------------------------------
CMenu::~CMenu()
{

}

//-----------------------------------------------------------------------------------------------
// 生成
//
//const D3DXVECTOR3& pos → 生成する座標位置
//-----------------------------------------------------------------------------------------------
CMenu* CMenu::Create(const D3DXVECTOR3& pos)
{
	// ポインタクラスを宣言
	CMenu* pMenu = new CMenu;

	if (pMenu != nullptr)
	{// もしnullptrではなかったら
	 // 初期化
		pMenu->Init(pos);
	}

	return pMenu;
}

//-----------------------------------------------------------------------------------------------
// 初期化
//
// const D3DXVECTOR3& pos → 最初に表示する座標位置
//-----------------------------------------------------------------------------------------------
HRESULT CMenu::Init(const D3DXVECTOR3& pos)
{
	//サイズ
	CObject2D::SetSize(D3DXVECTOR3(MENU_WIDTH, MENU_HEIGHT, 0.0f));

	CObject2D::Init(pos);

	// 親を指定
	SetObjectParent(CObject::OBJECT_PARENT_TITLE);
	//オブジェクトタイプを設定
	SetObjectType(OBJECT_TYPE::OBJECT_TYPE_MENU);

	return S_OK;
}

//-----------------------------------------------------------------------------------------------
// 終了
//-----------------------------------------------------------------------------------------------
void CMenu::Uninit()
{
	CObject2D::Uninit();
}

//-----------------------------------------------------------------------------------------------
// 更新
//-----------------------------------------------------------------------------------------------
void CMenu::Update()
{
	// 状態
	State();
}

//-----------------------------------------------------------------------------------------------
// 描画
//-----------------------------------------------------------------------------------------------
void CMenu::Draw()
{
	CObject2D::Draw();
}

//-----------------------------------------------------------------------------------------------
// 状態の設定
//
// MENU_STATE state → 状態
//-----------------------------------------------------------------------------------------------
void CMenu::SetState(MENU_STATE state)
{
	m_state = state;
}

//-----------------------------------------------------------------------------------------------
// 状態の取得
//-----------------------------------------------------------------------------------------------
CMenu::MENU_STATE CMenu::GetState()
{
	return m_state;
}

//-----------------------------------------------------------------------------------------------
// 状態
//-----------------------------------------------------------------------------------------------
void CMenu::State()
{
	switch (m_state)
	{
		// 決定していない
	case MENU_STATE_NO_DECISION:
		CObject2D::SetColor(D3DXCOLOR(0.5f,0.5f,0.5f,1.0f));
		break;
		// 決定した
	case MENU_STATE_DECISION:
		Decision();
		break;
		// 点滅
	case MENU_STATE_BLINK:
		Blink();

		// カウントを増やす
		m_nCount++;
		break;
		// その他
	default:
		break;
	}
}

//-----------------------------------------------------------------------------------------------
// 決定した
//-----------------------------------------------------------------------------------------------
void CMenu::Decision()
{
	CObject2D::SetColor(D3DXCOLOR(1.0f,1.0f,1.0f,1.0f));
}

//-----------------------------------------------------------------------------------------------
// 点滅
//-----------------------------------------------------------------------------------------------
void CMenu::Blink()
{
	if (m_nCount % MENU_INTERVAL_BLINK == 0)
	{
		CObject2D::SetColor(D3DXCOLOR(0.0f, 0.0f, 0.0f, 0.0f));
	}

	if (m_nCount % MENU_INTERVAL_BLINK == 10)
	{
		CObject2D::SetColor(D3DXCOLOR(1.0f, 1.0f, 1.0f, 1.0f));
	}
}